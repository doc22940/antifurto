<html>
    <head>
        <link rel="stylesheet" type="text/css" href="styles.css" />
        <title>Antifurto</title>
    </head>

    <body>
        <h1>Antifurto</h1>
        
        This is Antifurto by berta.

        <h2>Monitoring commands</h2>
        <div>
            <input id='startcmd' type='button' value='Start monitoring' class='button'/>
            <input id='stopcmd' type='button' value='Stop monitoring' class='button'/>
            <div id='cmdresult'></div>
        </div>

        <h2>Main pages</h2>
        <div>
            <a href='archive.php' class='button'>Recording archive</a>
            <a href='live.html' class='button'>Live view</a>
        </div>

        <script type='text/javascript'>
            function getUrl(url, outDiv) {
                return function() {
                    var request = new XMLHttpRequest();
                    request.open('GET', url, true);
                    request.onload = function() {
                        response = JSON.parse(this.responseText);
                        // response is { result: int, log: string }
                        var out = document.getElementById(outDiv);
                        if (response.result == 0)
                            out.innerHTML = 'Succesful';
                        else {
                            out.innerHTML = 'Error executing command';
                            console.log(response.log);
                        }
                    }
                    request.send();
                }
            }
            document.getElementById('startcmd').onclick =
                getUrl('controller/monitoring.php?start=1', 'cmdresult');
            document.getElementById('stopcmd').onclick =
                getUrl('controller/monitoring.php?stop=1', 'cmdresult');
        </script>
    </body>
</html>
